<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Twitter View - twitter.view.js</title>

  <link rel="stylesheet" href="../../../assets/style.css">

  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"/>
  <meta name="groc-relative-root" content="../../../"/>
  <meta name="groc-document-path" content="_static\modules\twitter\twitter.view.js"/>
  
</head>
<body>
  <div id="file-area">
    <div id="meta">
      <code class="file-path">
      
        _static\modules\twitter\twitter.view.js
      
      </code>
    </div>
    <div id="document">
    
      <div class="segment">
      
        <div class="comments ">
          <div class="wrapper"><h1 id="twitter-view"><a href="#twitter-view" class="anchor"></a>Twitter View</h1><p>This is our view layer tied with the events coming frm
<code>twitter.model.coffee</code> and rendering the response data
to the page.</p>
</div>
        </div>
      
      
        <div class="code"><pre class="wrapper">(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
  <span class="hljs-keyword">var</span> TwitterView;

  TwitterView = (<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
    <span class="hljs-keyword">var</span> self;

    self = {};
</pre></div>
      
      </div>
    
      <div class="segment">
      
        <div class="comments ">
          <div class="wrapper"><h2 id="constructor"><a href="#constructor" class="anchor"></a>Constructor</h2></div>
        </div>
      
      
        <div class="code"><pre class="wrapper">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">TwitterView</span><span class="hljs-params">(el, tpl)</span> {</span>
      <span class="hljs-keyword">this</span>.log.add(<span class="hljs-string">'notification'</span>, <span class="hljs-string">'[View] Constructed.'</span>, <span class="hljs-keyword">this</span>);
      self = <span class="hljs-keyword">this</span>;
      self.$el = $(el);
      self.view = window[<span class="hljs-string">"JST"</span>][<span class="hljs-string">"modules/twitter/tweet.share.handlebars"</span>];
      PubSub.subscribe(<span class="hljs-string">'tweet/new'</span>, <span class="hljs-keyword">this</span>.handleTweet);
      PubSub.subscribe(<span class="hljs-string">'tweet/error'</span>, <span class="hljs-keyword">this</span>.handleError);
    }
</pre></div>
      
      </div>
    
      <div class="segment">
      
        <div class="comments doc-section">
          <div class="wrapper"><h2 id="this-log"><a href="#this-log" class="anchor"></a>this.log</h2><p>  Add local instance of logging to this module.
  Can be called with:</p>
</div>
        </div>
      
      
        <div class="code"><pre class="wrapper">    TwitterView.prototype.log = <span class="hljs-keyword">new</span> LogHandler(<span class="hljs-string">'Twitter'</span>);
</pre></div>
      
      </div>
    
      <div class="segment">
      
        <div class="comments ">
          <div class="wrapper"><h2 id="this-handletweet"><a href="#this-handletweet" class="anchor"></a>this.handleTweet</h2><p>  Called on the event of a new tweet being published</p>
</div>
        </div>
      
      
        <div class="code"><pre class="wrapper">    TwitterView.prototype.handleTweet = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e, data)</span> {</span>
      self.log.add(<span class="hljs-string">'notification'</span>, <span class="hljs-string">'[View] handleTweet called.'</span>, data);
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> data.tweet === <span class="hljs-string">'object'</span> &amp;&amp; <span class="hljs-keyword">typeof</span> data.tweet.friends === <span class="hljs-string">'undefined'</span>) {
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> data.tweet[<span class="hljs-number">0</span>] !== <span class="hljs-string">'undefined'</span>) {
          <span class="hljs-keyword">return</span> self.renderTweet(data.tweet[<span class="hljs-number">0</span>]);
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">return</span> self.renderTweet(data.tweet);
        }
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">return</span> self.log.add(<span class="hljs-string">'warning'</span>, <span class="hljs-string">'[View] data appears to be undefined or not an object.'</span>, data);
      }
    };
</pre></div>
      
      </div>
    
      <div class="segment">
      
        <div class="comments ">
          <div class="wrapper"><h2 id="this-handleerror"><a href="#this-handleerror" class="anchor"></a>this.handleError</h2><p>  Handle error pubsub event from Twitter model</p>
</div>
        </div>
      
      
        <div class="code"><pre class="wrapper">    TwitterView.prototype.handleError = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e, err)</span> {</span>
      <span class="hljs-keyword">return</span> self.$el.html(<span class="hljs-string">'There was an error connecting with the server.'</span>);
    };
</pre></div>
      
      </div>
    
      <div class="segment">
      
        <div class="comments ">
          <div class="wrapper"><h2 id="this-rendertweet"><a href="#this-rendertweet" class="anchor"></a>this.renderTweet</h2><p>  Using our handlebars template we render the new tweet
  to our module.</p>
</div>
        </div>
      
      
        <div class="code"><pre class="wrapper">    TwitterView.prototype.renderTweet = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(tweet)</span> {</span>
      self.$el.html(self.view(tweet));
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.log.add(<span class="hljs-string">'notification'</span>, <span class="hljs-string">'[View] View rendered.'</span>, self.$el.html());
    };

    <span class="hljs-keyword">return</span> TwitterView;

  })();

  define(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
    <span class="hljs-keyword">return</span> TwitterView;
  });

}).call(<span class="hljs-keyword">this</span>);

<span class="hljs-comment">//@ sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidHdpdHRlci52aWV3LmpzIiwic291cmNlcyI6WyJ0d2l0dGVyLnZpZXcuY29mZmVlIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7Ozs7Q0FBQTtDQUFBO0NBQUE7Q0FBQSxLQUFBLEtBQUE7O0NBQUEsQ0FPTTtDQUNKLEdBQUEsSUFBQTs7Q0FBQSxDQUFBLENBQU8sQ0FBUDs7Q0FFQTs7O0NBRkE7O0NBS2EsQ0FBQSxDQUFBLENBQUEsaUJBQUM7Q0FFWixDQUF5QixDQUFyQixDQUFILEVBQUQsUUFBQSxPQUFBO0NBQUEsRUFHTyxDQUFQLEVBQUE7Q0FIQSxDQU1XLENBQVgsQ0FBSSxFQUFKO0NBTkEsRUFTWSxDQUFSLENBQWUsQ0FBbkIsa0NBQTBCO0NBVDFCLENBWThCLEVBQUMsRUFBL0IsR0FBQSxFQUFBO0NBWkEsQ0FhZ0MsRUFBQyxFQUFqQyxHQUFBLEVBQUEsRUFBQTtDQXBCRixJQUthOztDQWlCYjs7Ozs7O0NBdEJBOztDQUFBLEVBNEJBLENBQVMsS0FBQSxDQUFBOztDQUVUOzs7O0NBOUJBOztDQUFBLENBa0NpQixDQUFKLENBQUEsS0FBQyxFQUFkO0NBRUUsQ0FBNkIsQ0FBckIsQ0FBSixFQUFKLFFBQUEsY0FBQTtBQUdHLENBQUgsR0FBRyxDQUFBLENBQUgsQ0FBcUMsQ0FBbEMsR0FBSDtBQUVLLENBQUgsR0FBRyxDQUFrQixDQUFsQixFQUFILEdBQUE7Q0FDTyxHQUFELENBQXdCLE1BQTVCLE1BQUE7TUFERixJQUFBO0NBSU8sR0FBRCxDQUFKLE1BQUEsTUFBQTtVQU5KO01BQUEsRUFBQTtDQVNPLENBQW1CLENBQWhCLENBQUosS0FBSixNQUFBLHdDQUFBO1FBZFM7Q0FsQ2IsSUFrQ2E7O0NBZ0JiOzs7O0NBbERBOztDQUFBLENBc0RpQixDQUFKLE1BQUMsRUFBZDtDQUNPLEVBQUcsQ0FBSixTQUFKLG1DQUFBO0NBdkRGLElBc0RhOztDQUdiOzs7OztDQXpEQTs7Q0FBQSxFQThEYSxFQUFBLElBQUMsRUFBZDtDQUNFLEVBQVEsQ0FBSixDQUFVLENBQWQ7Q0FHQyxDQUF3QixDQUFyQixDQUFILFNBQUQsQ0FBQSxTQUFBO0NBbEVGLElBOERhOztDQTlEYjs7Q0FSRjs7Q0FBQSxDQTZFQSxDQUFPLEdBQVAsR0FBTztDQUNMLFVBQU87Q0FEVCxFQUFPO0NBN0VQIn0=</span></pre></div>
      
      </div>
    
    </div>
  </div>

  <script src="../../../toc.js"></script>
  <script src="../../../assets/libs.js"></script>
  <script src="../../../assets/behavior.js"></script>
</body>
</html>